openapi: "3.1.0"

info:
  version: "0.2.0"

  title: test.test

  termsOfService: 'https://test.test/terms/'

  contact:
    email: info@aequa-tech.com
    url: 'https://aequa-tech.com/contact'

  license:
    name: Apache 2.0
    url: 'http://www.apache.org/licenses/LICENSE-2.0.html'

  x-logo:
    url: 'https://aequa-tech.com/wp-content/uploads/2023/11/aequa-logo.svg'

  description: |
    Debunker Api description

servers:
  - url: "https://test.test/api/v1"

externalDocs:
  description: Find the full documentation
  url: 'ourexternaldoc.org'

paths:
  /users/status:
    get:
      security:
        - apiKey: []
          apiSecret: []
      summary: The user's status linked to the provided api and secret keys.
      description: Returns the status of the user linked to the provided api and secret keys. It also returns the number of tokens available for that key pair
      parameters:
        - in: header
          name: Accept-language
          required: false
          schema:
            $ref: "#/components/schemas/language"
      responses:
        "200":
          description: The user's status linked to the provided api and secret keys.
          content:
            application/json:
              schema:
                type: object
                properties:
                  user:
                    $ref: '#/components/schemas/user'
                  available_tokens:
                    type: number
                    minimum: 0
          headers:
            Content-Type:
              $ref: "#/components/headers/Content-Type"
            Content-Length:
              $ref: "#/components/headers/Content-Length"
            X-RateLimit-Limit:
              $ref: "#/components/headers/X-RateLimit-Limit"
            X-RateLimit-Remaining:
              $ref: "#/components/headers/X-RateLimit-Remaining"
            X-RateLimit-Reset:
              $ref: "#/components/headers/X-RateLimit-Reset"

        "401":
          $ref: "#/components/responses/unauthorized"

        "429":
          $ref: "#/components/responses/tooManyRequests"

        "500":
          $ref: "#/components/responses/error"

  /scrape:
    post:
      security:
        - apiKey: []
          apiSecret: []
      summary: Request for an article analysis
      description: Description
      parameters:
        - in: header
          name: Accept-language
          required: false
          schema:
            $ref: "#/components/schemas/language"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                url:
                  $ref: "#/components/schemas/basicUrl"
                analysisTypes:
                  $ref: "#/components/schemas/analysisTypes"
                contentLanguage:
                  $ref: "#/components/schemas/language"
                retry:
                  $ref: "#/components/schemas/retry"
                maxRetries:
                  $ref: "#/components/schemas/maxRetries"
                timeout:
                  $ref: "#/components/schemas/timeout"
                maxChars:
                  $ref: "#/components/schemas/charLimit"
              required:
                - url
                - analysisTypes
      responses:
        "200":
          description: The request has been processed
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/requestResponse"
          headers:
            Content-Type:
              $ref: "#/components/headers/Content-Type"
            Content-Length:
              $ref: "#/components/headers/Content-Length"
            X-RateLimit-Limit:
              $ref: "#/components/headers/X-RateLimit-Limit"
            X-RateLimit-Remaining:
              $ref: "#/components/headers/X-RateLimit-Remaining"
            X-RateLimit-Reset:
              $ref: "#/components/headers/X-RateLimit-Reset"

        "400":
          $ref: '#/components/responses/invalid'

        "401":
          $ref: "#/components/responses/unauthorized"

        "403":
          $ref: "#/components/responses/forbidden"

        "429":
          $ref: "#/components/responses/tooManyRequests"

        "500":
          $ref: "#/components/responses/error"

webhooks:
  evaluation:
    post:
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                url:
                  $ref: "#/components/schemas/basicUrl"
                status:
                  type: integer
                  description: Indicates the status of the scrape request made.
                analysisType:
                  type: string
                  enum: [evaluation]
                data:
                  oneOf:
                    - $ref: "#/components/schemas/notValidResponse"
                    - $ref: "#/components/schemas/evaluationPayload"
                  discriminator:
                    propertyName: status
              required:
                - url
                - status
                - analysisType
                - data

  explanation:
    post:
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                url:
                  $ref: "#/components/schemas/basicUrl"
                status:
                  type: integer
                analysisType:
                  type: string
                  enum: [explanation]
                data:
                  oneOf:
                    - $ref: "#/components/schemas/notValidResponse"
                    - $ref: "#/components/schemas/explanationPayload"
                  discriminator:
                    propertyName: status
              required:
                - url
                - status
                - analysisType
                - data

components:
  headers:
    Content-Type:
      schema:
        type: string
      description: The content type of the response body

    Content-Length:
      schema:
        type: integer
      description: The content length of the response body (in bytes)

    X-RateLimit-Limit:
      schema:
        type: integer
      description: Request limit per hour.

    X-RateLimit-Remaining:
      schema:
        type: integer
      description: The number of requests left for the time window.

    X-RateLimit-Reset:
      schema:
        type: string
        format: date-time
      description: The time at which the rate limit resets, specified in UTC epoch time (in seconds).

  responses:
    error:
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/notValidResponse'
      description: There were problems processing the request
      headers:
        Content-Length:
          $ref: '#/components/headers/Content-Length'
        Content-Type:
          $ref: '#/components/headers/Content-Type'
        X-RateLimit-Limit:
          $ref: '#/components/headers/X-RateLimit-Limit'
        X-RateLimit-Remaining:
          $ref: '#/components/headers/X-RateLimit-Remaining'
        X-RateLimit-Reset:
          $ref: '#/components/headers/X-RateLimit-Reset'

    forbidden:
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/notValidResponse'
      description: The request is understood, but it has been refused or access is not allowed.
      headers:
        Content-Length:
          $ref: '#/components/headers/Content-Length'
        Content-Type:
          $ref: '#/components/headers/Content-Type'
        X-RateLimit-Limit:
          $ref: '#/components/headers/X-RateLimit-Limit'
        X-RateLimit-Remaining:
          $ref: '#/components/headers/X-RateLimit-Remaining'
        X-RateLimit-Reset:
          $ref: '#/components/headers/X-RateLimit-Reset'

    invalid:
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/notValidResponse'
      description: The request was invalid or cannot be otherwise served.
      headers:
        Content-Length:
          $ref: '#/components/headers/Content-Length'
        Content-Type:
          $ref: '#/components/headers/Content-Type'
        X-RateLimit-Limit:
          $ref: '#/components/headers/X-RateLimit-Limit'
        X-RateLimit-Remaining:
          $ref: '#/components/headers/X-RateLimit-Remaining'
        X-RateLimit-Reset:
          $ref: '#/components/headers/X-RateLimit-Reset'

    tooManyRequests:
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/notValidResponse'
      description: Too Many Requests. Reached the APIs rate
      headers:
        Content-Length:
          $ref: '#/components/headers/Content-Length'
        Content-Type:
          $ref: '#/components/headers/Content-Type'
        X-RateLimit-Limit:
          $ref: '#/components/headers/X-RateLimit-Limit'
        X-RateLimit-Remaining:
          $ref: '#/components/headers/X-RateLimit-Remaining'
        X-RateLimit-Reset:
          $ref: '#/components/headers/X-RateLimit-Reset'

    unauthorized:
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/notValidResponse'
      description: Your request cannot be authenticated.
      headers:
        Content-Length:
          $ref: '#/components/headers/Content-Length'
        Content-Type:
          $ref: '#/components/headers/Content-Type'
        X-RateLimit-Limit:
          $ref: '#/components/headers/X-RateLimit-Limit'
        X-RateLimit-Remaining:
          $ref: '#/components/headers/X-RateLimit-Remaining'
        X-RateLimit-Reset:
          $ref: '#/components/headers/X-RateLimit-Reset'

  securitySchemes:
    apiKey:
      type: apiKey
      in: header
      name: X-API-Key

    apiSecret:
      type: apiKey
      in: header
      name: X-API-Secret

  schemas:
    affectiveStyle:
      description: desc
      properties:
        anger:
          $ref: '#/components/schemas/anger'
        fear:
          $ref: '#/components/schemas/fear'
        joy:
          $ref: '#/components/schemas/joy'
        negativeSentiment:
          $ref: '#/components/schemas/negativeSentiment'
        positiveSentiment:
          $ref: '#/components/schemas/positiveSentiment'
        sadness:
          $ref: '#/components/schemas/sadness'
      type: object

    aggressivePunctuation:
      description: it identifies the presence of aggressive punctuation in the text
      properties:
        absolute:
          $ref: '#/components/schemas/categoricalValue'
        global:
          $ref: '#/components/schemas/scoreType1'
        local:
          $ref: '#/components/schemas/scoreType1'
      summary: the text contains aggressive punctuation
      type: object

    analysisTypes:
      minProperties: 1
      properties:
        evaluation:
          $ref: '#/components/schemas/evaluationAnalysis'
        explanation:
          $ref: '#/components/schemas/explanationAnalysis'
      type: object

    anger:
      description: description
      properties:
        absolute:
          $ref: '#/components/schemas/categoricalValue'
        global:
          $ref: '#/components/schemas/scoreType1'
        local:
          $ref: '#/components/schemas/scoreType1'
      summary: summary
      type: object

    basicUrl:
      format: stringUri
      type: string

    categoricalValue:
      description: a categorical representation of a feature
      format: int32
      type: integer

    charLimit:
      default: 10000
      description: The limit of charachters of a text to be analyzed.
      maximum: 15000
      type: integer

    clickBait:
      description: desc
      properties:
        misleadingHeadline:
          $ref: '#/components/schemas/misleadingHeadline'
      type: object

    dangerousStyle:
      description: desc
      properties:
        flame:
          $ref: '#/components/schemas/flame'
        irony:
          $ref: '#/components/schemas/irony'
        stereotype:
          $ref: '#/components/schemas/stereotype'
      type: object

    email:
      format: email
      type: string

    emoji:
      description: description
      properties:
        absolute:
          $ref: '#/components/schemas/categoricalValue'
        global:
          $ref: '#/components/schemas/scoreType1'
        local:
          $ref: '#/components/schemas/scoreType1'
      summary: summary
      type: object

    evaluationAnalysis:
      properties:
        callbackUrl:
          $ref: '#/components/schemas/basicUrl'
      required:
        - callbackUrl
      type: object

    evaluationPayload:
      properties:
        affectiveStyle:
          $ref: '#/components/schemas/affectiveStyle'
        analysisId:
          $ref: '#/components/schemas/id'
        clickBait:
          $ref: '#/components/schemas/clickBait'
        dangerousStyle:
          $ref: '#/components/schemas/dangerousStyle'
        informalStyle:
          $ref: '#/components/schemas/informalStyle'
        readability:
          $ref: '#/components/schemas/readability'
      type: object

    explanationAffective:
      properties:
        explanationAnger:
          $ref: '#/components/schemas/explanationAnger'
        explanationDim:
          $ref: '#/components/schemas/explanationType'
        explanationFear:
          $ref: '#/components/schemas/explanationFear'
        explanationJoy:
          $ref: '#/components/schemas/explanationJoy'
        explanationNegativeSentiment:
          $ref: '#/components/schemas/explanationNegativeSentiment'
        explanationPositiveSentiment:
          $ref: '#/components/schemas/explanationPositiveSentiment'
        explanationSadness:
          $ref: '#/components/schemas/explanationSadness'
      required:
        - explanationType
      summary: all the explanations of dangerous features

    explanationAnalysis:
      properties:
        callbackUrl:
          $ref: '#/components/schemas/basicUrl'
        explanationType:
          $ref: '#/components/schemas/explanationType'
      required:
        - callbackUrl
        - explanationType
      type: object

    explanationAnger:
      properties:
        probability:
          $ref: '#/components/schemas/scoreType1'
        token:
          $ref: '#/components/schemas/token'
      summary: the piece of text that contribute to determine that an article expresses anger

    explanationDanger:
      properties:
        explanationDim:
          $ref: '#/components/schemas/explanationType'
        explanationFlame:
          $ref: '#/components/schemas/explanationFlame'
        explanationIrony:
          $ref: '#/components/schemas/explanationIrony'
        explanationStereotype:
          $ref: '#/components/schemas/explanationStereotype'
      required:
        - explanationType
      summary: all the explanations of dangerous features

    explanationFear:
      properties:
        probability:
          $ref: '#/components/schemas/scoreType1'
        token:
          $ref: '#/components/schemas/token'
      summary: the piece of text that contribute to determine that an article expresses anger

    explanationFlame:
      properties:
        probability:
          $ref: '#/components/schemas/scoreType1'
        token:
          $ref: '#/components/schemas/token'
      summary: the piece of text that contribute to determine that an article expresses inflammatory contents

    explanationIrony:
      properties:
        probability:
          $ref: '#/components/schemas/scoreType1'
        token:
          $ref: '#/components/schemas/token'
      summary: the piece of text that contribute to determine that an article expresses ironic contents

    explanationJoy:
      properties:
        probability:
          $ref: '#/components/schemas/scoreType1'
        token:
          $ref: '#/components/schemas/token'
      summary: the piece of text that contribute to determine that an article expresses joy

    explanationNegativeSentiment:
      properties:
        probability:
          $ref: '#/components/schemas/scoreType1'
        token:
          $ref: '#/components/schemas/token'
      summary: the piece of text that contribute to determine that an article expresses a negative sentiment

    explanationPayload:
      discriminator:
        propertyName: explanationDim
      oneOf:
        - $ref: '#/components/schemas/explanationAffective'
        - $ref: '#/components/schemas/explanationDanger'

    explanationPositiveSentiment:
      properties:
        probability:
          $ref: '#/components/schemas/scoreType1'
        token:
          $ref: '#/components/schemas/token'
      summary: the piece of text that contribute to determine that an article expresses a positive sentiment

    explanationSadness:
      properties:
        probability:
          $ref: '#/components/schemas/scoreType1'
        token:
          $ref: '#/components/schemas/token'
      summary: the piece of text that contribute to determine that an article expresses sadness

    explanationStereotype:
      properties:
        probability:
          $ref: '#/components/schemas/scoreType1'
        token:
          $ref: '#/components/schemas/token'
      summary: the piece of text that contribute to determine that an article expresses stereotypical contents

    explanationType:
      enum: [affectiveStyle, dangerousStyle]
      name: explanation
      type: string

    fear:
      description: description
      properties:
        absolute:
          $ref: '#/components/schemas/categoricalValue'
        global:
          $ref: '#/components/schemas/scoreType1'
        local:
          $ref: '#/components/schemas/scoreType1'
      summary: summary
      type: object

    flame:
      description: description
      properties:
        absolute:
          $ref: '#/components/schemas/categoricalValue'
        global:
          $ref: '#/components/schemas/scoreType1'
        local:
          $ref: '#/components/schemas/scoreType1'
      summary: summary
      type: object

    fleshReadingEase:
      description: description
      properties:
        absolute:
          $ref: '#/components/schemas/categoricalValue'
        global:
          $ref: '#/components/schemas/scoreType1'
        local:
          $ref: '#/components/schemas/scoreType1'
      summary: summary
      type: object

    id:
      description: An unique id used for handling next APIs requests
      type: string

    informalStyle:
      description: it returns the informal style score, which is composed of a list of all sub-features and their average
      properties:
        aggressivePunctuation:
          $ref: '#/components/schemas/aggressivePunctuation'
        emoji:
          $ref: '#/components/schemas/emoji'
        intensifiers:
          $ref: '#/components/schemas/intensifiers'
        interrogatives:
          $ref: '#/components/schemas/interrogatives'
        modals:
          $ref: '#/components/schemas/modals'
        overallScore:
          $ref: '#/components/schemas/averageValue'
        personalStyle:
          $ref: '#/components/schemas/personalStyle'
        secondPerson:
          $ref: '#/components/schemas/secondPerson'
        shortened:
          $ref: '#/components/schemas/shortenedForms'
        uncommonPunctuation:
          $ref: '#/components/schemas/uncommonPunctuation'
        uppercaseWords:
          $ref: '#/components/schemas/uppercaseWords'
      type: object

    intensifiers:
      description: description
      properties:
        absolute:
          $ref: '#/components/schemas/categoricalValue'
        global:
          $ref: '#/components/schemas/scoreType1'
        local:
          $ref: '#/components/schemas/scoreType1'
      summary: summary
      type: object

    interrogatives:
      description: description
      properties:
        absolute:
          $ref: '#/components/schemas/categoricalValue'
        global:
          $ref: '#/components/schemas/scoreType1'
        local:
          $ref: '#/components/schemas/scoreType1'
      summary: summary
      type: object

    irony:
      description: description
      properties:
        absolute:
          $ref: '#/components/schemas/categoricalValue'
        global:
          $ref: '#/components/schemas/scoreType1'
        local:
          $ref: '#/components/schemas/scoreType1'
      summary: summary
      type: object

    joy:
      description: description
      properties:
        absolute:
          $ref: '#/components/schemas/categoricalValue'
        global:
          $ref: '#/components/schemas/scoreType1'
        local:
          $ref: '#/components/schemas/scoreType1'
      summary: summary
      type: object

    language:
      default: it
      description: The language of the article that you want to analyze. Actually you can choose between Italian (it) and English (en)
      enum: [it,en]
      type: string

    maxRetries:
      default: 2
      description: The total number of retries. Default is 2
      maximum: 5
      type: integer

    misleadingHeadline:
      description: description
      properties:
        absolute:
          $ref: '#/components/schemas/categoricalValue'
        global:
          $ref: '#/components/schemas/scoreType1'
        local:
          $ref: '#/components/schemas/scoreType1'
      summary: summary
      type: object

    modals:
      description: description
      properties:
        absolute:
          $ref: '#/components/schemas/categoricalValue'
        global:
          $ref: '#/components/schemas/scoreType1'
        local:
          $ref: '#/components/schemas/scoreType1'
      summary: summary
      type: object

    negativeSentiment:
      description: description
      properties:
        absolute:
          $ref: '#/components/schemas/categoricalValue'
        global:
          $ref: '#/components/schemas/scoreType1'
        local:
          $ref: '#/components/schemas/scoreType1'
      summary: summary
      type: object

    notValidResponse:
      properties:
        message:
          description: A text message describing the response.
          type: string
      type: object

    personalStyle:
      description: description
      properties:
        absolute:
          $ref: '#/components/schemas/categoricalValue'
        global:
          $ref: '#/components/schemas/scoreType1'
        local:
          $ref: '#/components/schemas/scoreType1'
      summary: summary
      type: object

    positiveSentiment:
      description: description
      properties:
        absolute:
          $ref: '#/components/schemas/categoricalValue'
        global:
          $ref: '#/components/schemas/scoreType1'
        local:
          $ref: '#/components/schemas/scoreType1'
      summary: summary
      type: object

    readability:
      description: desc
      properties:
        fleshReadingEase:
          $ref: '#/components/schemas/fleshReadingEase'
      type: object

    requestResponse:
      properties:
        message:
          description: A text message describing the response.
          type: string
        url:
          description: The url provided for analysis.
          type: string
      required:
        - message
      type: object

    retry:
      default: false
      description: Choose if you want to retry the call to the API. Default is false
      type: boolean

    sadness:
      description: description
      properties:
        absolute:
          $ref: '#/components/schemas/categoricalValue'
        global:
          $ref: '#/components/schemas/scoreType1'
        local:
          $ref: '#/components/schemas/scoreType1'
      summary: summary
      type: object

    scoreType1:
      description: a score associated to a feature in the range 0-1
      format: float
      maximum: 1
      minimum: 0
      type: number

    scoreType2:
      description: aa score associated to a feature in the range -1-1
      format: float
      maximum: 1
      minimum: -1
      type: number

    secondPerson:
      description: it identifies all the occurrences of verbs conjugated at the first or second person
      properties:
        absolute:
          $ref: '#/components/schemas/categoricalValue'
        global:
          $ref: '#/components/schemas/scoreType1'
        local:
          $ref: '#/components/schemas/scoreType1'
      summary: the text contains verbs conjugated at the second or first person
      type: object

    shortenedForms:
      description: description
      properties:
        absolute:
          $ref: '#/components/schemas/categoricalValue'
        global:
          $ref: '#/components/schemas/scoreType1'
        local:
          $ref: '#/components/schemas/scoreType1'
      summary: summary
      type: object

    stereotype:
      description: description
      properties:
        absolute:
          $ref: '#/components/schemas/categoricalValue'
        global:
          $ref: '#/components/schemas/scoreType1'
        local:
          $ref: '#/components/schemas/scoreType1'
      summary: summary
      type: object

    timeout:
      default: 5
      description: It sets the timeout of a request to our APIs. It is expressed in seconds. Default is 5
      maximum: 20
      type: integer

    token:
      description: a chunck of text that corresponds to a word or a piece of word
      type: string

    uncommonPunctuation:
      description: description
      properties:
        absolute:
          $ref: '#/components/schemas/categoricalValue'
        global:
          $ref: '#/components/schemas/scoreType1'
        local:
          $ref: '#/components/schemas/scoreType1'
      summary: summary
      type: object

    uppercaseWords:
      description: description
      properties:
        absolute:
          $ref: '#/components/schemas/categoricalValue'
        global:
          $ref: '#/components/schemas/scoreType1'
        local:
          $ref: '#/components/schemas/scoreType1'
      summary: summary
      type: object

    user:
      properties:
        email:
          $ref: '#/components/schemas/email'
        name:
          type: string
        role:
          enum: [admin, user]
          type: string
      type: object
